<head>
	<script src="http://localhost:43001/socket.io/socket.io.js"></script>
	<script src="js/require.js"></script>
	<style>
	body {
		margin : 0;
	}
	</style>
</head>
<body>
	<canvas id=canvas></canvas>
	<script>
	require.config({
		baseUrl : '/',
		shim: {
			"Engine/Utility/underscore": {
				exports: "_"
			}
		}
	});
	require([
		'Engine/Utility/class',
		'Engine/Game/World',
		'Engine/View/WorldView',
		'Engine/Game/Platform'
	],
	function( _class, World, WorldView, Platform ){				
		var socket = io.connect('http://localhost:43001/');
		var name;
		
		socket.emit('requestLogin', prompt('What is your name ?') );
		
		function startGame( basebin )
		{
			var canvas = document.getElementById('canvas');
			var context = canvas.getContext('2d');
			var world = new World;
			
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
			
			world.parseBaseBin( basebin );
			
			function loop(){
				WorldView.render( context, world );
				
				requestAnimationFrame( loop );
			}
			
			loop();
		}
		
		socket.on('base', function( data ){
			console.log( data );
			name = data.name;
			startGame( data.basebin );
		});
	});
	</script>
</body>
